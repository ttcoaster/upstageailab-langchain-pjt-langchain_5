# LangChainì„ í™œìš©í•œ RAG ì‹œìŠ¤í…œ

<br>

## ğŸ’» í”„ë¡œì íŠ¸ ì†Œê°œ
### <í”„ë¡œì íŠ¸ ì†Œê°œ>
- LangChain í”„ë¡œì íŠ¸ë¡œ, RAG(Retrieval-Augmented Generation) ì‹œìŠ¤í…œì„ êµ¬í˜„í•©ë‹ˆë‹¤.
- PDF ë¬¸ì„œë¥¼ í™œìš©í•˜ì—¬ ì§ˆë¬¸-ë‹µë³€ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.

### <ì‘í’ˆ ì†Œê°œ>
- LangChain, Upstage API, FAISSë¥¼ í™œìš©í•œ ë¬¸ì„œ ê¸°ë°˜ ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œ
- PDF ë¬¸ì„œ ë¡œë“œ, í…ìŠ¤íŠ¸ ë¶„í• , ì„ë² ë”© ìƒì„±, ë²¡í„° ì €ì¥ì†Œ êµ¬ì¶•, ê²€ìƒ‰ ë° ë‹µë³€ ìƒì„± íŒŒì´í”„ë¼ì¸ êµ¬í˜„

<br>

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦â€ğŸ‘¦ íŒ€ êµ¬ì„±ì›

| ![ë¥˜ì§€í—Œ](https://avatars.githubusercontent.com/u/10584296?v=4) | ![ê¹€íƒœí˜„](https://avatars.githubusercontent.com/u/7031901?v=4) | ![ë°•ì§„ì„­](https://avatars.githubusercontent.com/u/208775216?v=4) | ![ë¬¸ì§„ìˆ™](https://avatars.githubusercontent.com/u/204665219?v=4) | ![ê¹€ì¬ë•](https://avatars.githubusercontent.com/u/33456585?v=4) |
| :--------------------------------------------------------------: | :--------------------------------------------------------------: | :--------------------------------------------------------------: | :--------------------------------------------------------------: | :--------------------------------------------------------------: |
|            [ë¥˜ì§€í—Œ](https://github.com/mahomi)             |            [ê¹€íƒœí˜„](https://github.com/huefilm)             |            [ë°•ì§„ì„­](https://github.com/seob1504)             |            [ë¬¸ì§„ìˆ™](https://github.com/June3723)             |            [ê¹€ì¬ë•](https://github.com/ttcoaster)             |
|                   íŒ€ì¥, RAG ì•„í‚¤í…ì²˜ ì„¤ê³„<br/>LangChain íŒŒì´í”„ë¼ì¸ êµ¬í˜„                   |                   ë¬¸ì„œ ì „ì²˜ë¦¬ ë° ë¶„í• <br/>PDF ë¡œë” ìµœì í™”                   |                   ì„ë² ë”© ë° ë²¡í„° ì €ì¥ì†Œ<br/>FAISS ì„±ëŠ¥ íŠœë‹                   |                   í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§<br/>ë‹µë³€ í’ˆì§ˆ ê°œì„                    |                   API í†µí•© ë° ë°°í¬<br/>í™˜ê²½ ì„¤ì • ê´€ë¦¬                   |

<br>

## ğŸ”¨ ê°œë°œ í™˜ê²½ ë° ê¸°ìˆ  ìŠ¤íƒ
- **ì£¼ ì–¸ì–´**: Python 3.10+
- **íŒ¨í‚¤ì§€ ê´€ë¦¬**: UV (Ultra-fast Python package manager)
- **í”„ë¡ íŠ¸ì—”ë“œ**: Streamlit (WebUI)
- **ì£¼ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬**:
  - **LangChain**: Community, Core, OpenAI, Upstage, Text Splitters
  - **FAISS**: ë²¡í„° ê²€ìƒ‰ ë° ì €ì¥
  - **PyMuPDF**: PDF ë¬¸ì„œ ì²˜ë¦¬  
  - **RAGAS**: RAG ì‹œìŠ¤í…œ í’ˆì§ˆ í‰ê°€
  - **pytest**: ë‹¨ìœ„/í†µí•© í…ŒìŠ¤íŠ¸
  - **SQLite**: ëŒ€í™” ë°ì´í„° ì €ì¥
  - **python-dotenv**: í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬
- **API**: Upstage AI (Chat, Embeddings)
- **ë²„ì „ ë° ì´ìŠˆê´€ë¦¬**: GitHub
- **í˜‘ì—… íˆ´**: GitHub, Slack

<br>

## Upstage API Key ë°œê¸‰
1. [Upstage AI Console](https://console.upstage.ai/docs/getting-started)ì— ì ‘ì†í•©ë‹ˆë‹¤.
2. ìƒë‹¨ **Dashboard** ë¥¼ í´ë¦­
3. ì¢Œì¸¡ ë©”ë‰´ì—ì„œ **API Key**ë¥¼ ì„ íƒí•©ë‹ˆë‹¤.
4. **API Key ë°œê¸‰** ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í‚¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
5. ë°œê¸‰ëœ API Keyë¥¼ ë³µì‚¬í•˜ì—¬  `.env` íŒŒì¼ì— ì¶”ê°€í•©ë‹ˆë‹¤. (env_templateíŒŒì¼ì„ ì°¸ê³ ) (`UPSTAGE_API_KEY=ë°œê¸‰ë°›ì€_API_í‚¤`)

## âš™ï¸ UV ëª…ë ¹ì–´ ì‚¬ìš©ë²•
### UV ì„¤ì¹˜
```bash
pip install uv
```

### ì£¼ìš” ëª…ë ¹ì–´
```bash
# ê¸°ë³¸ RAG ì‹œìŠ¤í…œ ì‹¤í–‰
uv run python code/baseline/baseline.py

# Streamlit WebUI ì‹¤í–‰
uv run streamlit run code/main.py

# RAG í’ˆì§ˆ í‰ê°€ ì‹¤í–‰
uv run python code/evaluate.py

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
uv run pytest code/tests/

# ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ì„¤ì¹˜
uv sync

# ìƒˆ íŒ¨í‚¤ì§€ ì¶”ê°€
uv add íŒ¨í‚¤ì§€ëª…
```

<br>

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
â”œâ”€â”€ code/
â”‚   â”œâ”€â”€ baseline/             # ê¸°ë³¸ RAG êµ¬í˜„
â”‚   â”‚   â”œâ”€â”€ baseline.py       # ë‹¨ì¼ íŒŒì¼ RAG ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ baseline_directoryloader.py  # ë‹¤ì¤‘ íŒŒì¼ ì²˜ë¦¬
â”‚   â”‚   â””â”€â”€ baseline_memory.py    # ë©”ëª¨ë¦¬ ê¸°ëŠ¥ í¬í•¨ ë²„ì „
â”‚   â”œâ”€â”€ modules/              # ëª¨ë“ˆí™”ëœ RAG ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ sql.py            # SQLite ëŒ€í™” ì €ì¥ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ logger.py         # ë¡œê¹… ì‹œìŠ¤í…œ
â”‚   â”‚   â”œâ”€â”€ vector_store.py   # ë²¡í„°ìŠ¤í† ì–´ ê´€ë¦¬ (í†µí•©ë¨)
â”‚   â”‚   â”œâ”€â”€ llm.py           # LLM ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ retriever.py     # ë¬¸ì„œ ê²€ìƒ‰ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ chat_history.py  # ì±„íŒ… íˆìŠ¤í† ë¦¬ ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ crawler.py       # ë¬¸ì„œ ë¡œë”© ê´€ë¦¬
â”‚   â”œâ”€â”€ tests/               # pytest í…ŒìŠ¤íŠ¸ ì½”ë“œ
â”‚   â”œâ”€â”€ utils/               # ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
â”‚   â”œâ”€â”€ main.py              # Streamlit WebUI
â”‚   â””â”€â”€ evaluate.py          # RAGAS í’ˆì§ˆ í‰ê°€ ë„êµ¬
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ pdf/                 # PDF ë¬¸ì„œë“¤
â”‚   â”œâ”€â”€ vectorstore/         # FAISS ë²¡í„°ìŠ¤í† ì–´
â”‚   â”œâ”€â”€ eval/                # í‰ê°€ ê´€ë ¨ ë°ì´í„°
â”‚   â”‚   â”œâ”€â”€ question_dataset.json      # í‰ê°€ìš© ì§ˆë¬¸-ë‹µë³€ ë°ì´í„°ì…‹
â”‚   â”‚   â””â”€â”€ evaluation_results/        # í‰ê°€ ê²°ê³¼ ì €ì¥
â””â”€â”€ README.md
```

<br>

## ğŸ’»â€‹ êµ¬í˜„ ê¸°ëŠ¥

### 1. ê¸°ë³¸ RAG ì‹œìŠ¤í…œ (baseline/)
- **baseline.py**: ë‹¨ì¼ íŒŒì¼ RAG ì‹œìŠ¤í…œ êµ¬í˜„
- **baseline_directoryloader.py**: ë‹¤ì¤‘ PDF íŒŒì¼ ì²˜ë¦¬
- **baseline_memory.py**: ëŒ€í™” ë©”ëª¨ë¦¬ ê¸°ëŠ¥ í¬í•¨

### 2. ëª¨ë“ˆí™”ëœ RAG ì‹œìŠ¤í…œ (modules/)
- **VectorStoreManager**: FAISS ë²¡í„°ìŠ¤í† ì–´ ê´€ë¦¬, ì¦ë¶„ ì—…ë°ì´íŠ¸, íŒŒì¼ ë³€ê²½ ê°ì§€
- **LLMManager**: Upstage Chat API í†µí•©, í”„ë¡¬í”„íŠ¸ ê´€ë¦¬
- **RetrieverManager**: ë¬¸ì„œ ê²€ìƒ‰, ìœ ì‚¬ë„ ê¸°ë°˜ ê²€ìƒ‰
- **ChatHistoryManager**: ëŒ€í™” ê¸°ë¡ ê´€ë¦¬, ë©”ëª¨ë¦¬ ê¸°ëŠ¥
- **SQLManager**: SQLite ê¸°ë°˜ ëŒ€í™” ì €ì¥
- **LoggerManager**: í†µí•© ë¡œê¹… ì‹œìŠ¤í…œ

### 3. Streamlit WebUI (main.py)
- ì‹¤ì‹œê°„ ì±„íŒ… ì¸í„°í˜ì´ìŠ¤
- ëŒ€í™” íˆìŠ¤í† ë¦¬ ê´€ë¦¬
- ë¬¸ì„œ ì†ŒìŠ¤ í‘œì‹œ
- ì„¤ì • íŒ¨ë„

### 4. í’ˆì§ˆ í‰ê°€ ì‹œìŠ¤í…œ (evaluate.py)
- **RAGAS ë©”íŠ¸ë¦­**: faithfulness, answer_relevancy, context_recall, answer_correctness
- **ë°ì´í„°ì…‹ ê¸°ë°˜ í‰ê°€**: ì‚¬ì „ ì •ì˜ëœ ì§ˆë¬¸-ë‹µë³€ ìŒ ì‚¬ìš©
- **ê²°ê³¼ ì €ì¥**: JSON í˜•íƒœë¡œ í‰ê°€ ê²°ê³¼ ì €ì¥
- **Upstage API í˜¸í™˜**: baseline.py ë°©ì‹ìœ¼ë¡œ RAGAS ì—°ë™

### 5. í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ (tests/)
- **pytest ê¸°ë°˜**: ëª¨ë“  ì£¼ìš” ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸
- **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**: ê° ëª¨ë“ˆë³„ ê¸°ëŠ¥ ê²€ì¦
- **í†µí•© í…ŒìŠ¤íŠ¸**: ì „ì²´ íŒŒì´í”„ë¼ì¸ ê²€ì¦

<br>

## ğŸ› ï¸ RAG ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```mermaid
flowchart TD
    A[PDF ë¬¸ì„œ] --> B[PyMuPDF ë¡œë”]
    B --> C[í…ìŠ¤íŠ¸ ë¶„í• <br/>RecursiveCharacterTextSplitter<br/>chunk_size: 1000, overlap: 50]
    C --> D[Upstage Embeddings<br/>embedding-query ëª¨ë¸]
    D --> E[FAISS ë²¡í„° ì €ì¥ì†Œ<br/>ë²¡í„° ì¸ë±ìŠ¤ êµ¬ì¶•]
    
    F[ì‚¬ìš©ì ì§ˆë¬¸] --> G[ì§ˆë¬¸ ì„ë² ë”©<br/>Upstage Embeddings]
    G --> H[ìœ ì‚¬ë„ ê²€ìƒ‰<br/>FAISS Retriever]
    E --> H
    H --> I[ê´€ë ¨ ë¬¸ì„œ ê²€ìƒ‰<br/>Top-K ë¬¸ì„œ ë°˜í™˜]
    
    I --> J[í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿<br/>ì§ˆë¬¸ + ì»¨í…ìŠ¤íŠ¸]
    J --> K[Upstage Chat API<br/>ë‹µë³€ ìƒì„±]
    K --> L[í•œêµ­ì–´ ë‹µë³€ ì¶œë ¥]
    
    style A fill:#e1f5fe
    style F fill:#e8f5e8
    style L fill:#fff3e0
    style E fill:#f3e5f5
    style K fill:#fce4ec
```

### ì£¼ìš” ì²˜ë¦¬ ë‹¨ê³„
1. **ë¬¸ì„œ ì „ì²˜ë¦¬**: PDF â†’ í…ìŠ¤íŠ¸ ì¶”ì¶œ â†’ ì²­í¬ ë¶„í• 
2. **ë²¡í„°í™”**: í…ìŠ¤íŠ¸ ì²­í¬ â†’ ì„ë² ë”© ë²¡í„° â†’ FAISS ì¸ë±ìŠ¤
3. **ê²€ìƒ‰**: ì§ˆë¬¸ ì„ë² ë”© â†’ ìœ ì‚¬ë„ ê²€ìƒ‰ â†’ ê´€ë ¨ ë¬¸ì„œ ì¶”ì¶œ  
4. **ìƒì„±**: ì§ˆë¬¸ + ì»¨í…ìŠ¤íŠ¸ â†’ LLM â†’ ìµœì¢… ë‹µë³€

<br>

## ğŸš¨â€‹ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…
### 1. OOO ì—ëŸ¬ ë°œê²¬

#### ì„¤ëª…
- _í”„ë¡œì íŠ¸ ì§„í–‰ ì¤‘ ë°œìƒí•œ íŠ¸ëŸ¬ë¸”ì— ëŒ€í•´ ì‘ì„±í•´ì£¼ì„¸ìš”_

#### í•´ê²°
- _í”„ë¡œì íŠ¸ ì§„í–‰ ì¤‘ ë°œìƒí•œ íŠ¸ëŸ¬ë¸” í•´ê²°ë°©ë²• ëŒ€í•´ ì‘ì„±í•´ì£¼ì„¸ìš”_

<br>

## ğŸ“Œ í”„ë¡œì íŠ¸ íšŒê³ 
### ë°•íŒ¨ìº 
- _í”„ë¡œì íŠ¸ íšŒê³ ë¥¼ ì‘ì„±í•´ì£¼ì„¸ìš”_

<br>

## ğŸ“°â€‹ ì°¸ê³ ìë£Œ
- _ì°¸ê³ ìë£Œë¥¼ ì²¨ë¶€í•´ì£¼ì„¸ìš”_
